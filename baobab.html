<head>
  <title>BAOBAB</title>
</head>

<body>
  {{#if contextMenu}}
    {{> nodeContextMenu}}
    <div class="context-menu-overlay"></div>
  {{/if}}

  {{> shareModal}}

  <div class="nav">
    <h1>
      <a href="/" class="home">Baobab</a>
    </h1> | {{> loginButtons}}
  </div>
</body>

<template name="tree">
  {{#if $eq content null}}
    <h2>&nbsp;</h2>
  {{else}}
    <h2 class="title">{{content}}</h2>
  {{/if}}
  <div class="list">
  {{#each getOrderedChildren}}
    {{> node}}
  {{/each}}
  </div>
</template>

<template name="node">
  <div class="item">
    <div class="bullet {{#if hasBeenShared}}shared{{/if}}">
      {{#if multiUser}}
        <div class="editor" style="left:{{getEditorDeindent}}px; border-color: {{generatedColor}}; color: {{generatedColor}}">
          <span>{{lastUpdatedBy.username}}</span>
        </div>
      {{/if}}
      {{#if hasChildren}}
      <a class="zoom" href="/{{_id}}">&mapstoup;</a>
      {{/if}}
      <div class="arrow{{getArrowIconClasses}}"></div>
      <div class="input" contentEditable></div>
    </div>
    {{#unless isCollapsedByCurrentUser}}
      <div class="list">
      {{#each getOrderedChildren}}
        {{> node}}
      {{/each}}
      </div>
    {{/unless}}
  </div>
</template>

<template name="nodeContextMenu">
  <div class="node-context-menu-positioner" {{position}}>
    <div class="node-context-menu">
      <ul>
        <li class="share">Sharing</li>
        <li class="delete">Delete</li>
      </ul>
    </div>
  </div>
</template>

<template name="shareModal">
  {{#if shareModalOpen}}
    {{#with node}}
      <div class="share-modal-overlay"></div>
      <div class="share-modal">
        <div class="title">
          Share settings for "{{content}}"

          <button class="close">Close popup</button>
        </div>

        <div class="body">
          <h3>Users</h3>

          <ul>
            {{#each permissions.readOnly}}
              <li>{{username}}, {{calendar date}}</li>
            {{/each}}
            {{#each permissions.readWrite}}
              <li>{{username}}, {{calendar date}}</li>
            {{/each}}
          </ul>

          <form class="share-to-user">
            <h4>Share with another Baobab user</h4>
            <input type="text" name="username" placeholder="username" />

            <input type="radio" name="permission" value="readOnly" checked/> Read Only
            <input type="radio" name="permission" value="readWrite" /> Editable

            <button>Share</button>
          </form>
        </div>
      </div>
    {{/with}}
  {{/if}}
</template>
